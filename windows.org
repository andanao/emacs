#+title: Windows Config
#+PROPERTY: header-args:emacs-lisp :tangle ./windows.el :results none
I really wish I didn't have to use windows but sometimes you don't have a choice

* Align Emacs and System Theme
Set the windows theme color from powershell, doesn't work from regular windows command line for some reason ¯\_(ツ)_/¯

You can also set the system to light mode replacing the ~AppsUseLightTheme~ with ~SystemUsesLightTheme~ but I like things not looking like Windows 95

#+begin_src emacs-lisp
(if
    (string= (car ads/switch-themes-var) "ads-dark")
    (setq win-theme "0")
    (setq win-theme "1"))

(defun ads/windows-align-emacs-darkmode ()
  (interactive)
  (if
      (string= (car ads/switch-themes-var) "ads-dark")
      (setq win-theme "0")
    (setq win-theme "1"))
  (with-temp-buffer
    (shell-command
     (concat
      "powershell; New-ItemProperty -Path HKCU:/SOFTWARE/Microsoft/Windows/CurrentVersion/Themes/Personalize -Name AppsUseLightTheme -Value "
      win-theme
      " -Type Dword -Force; dir")
     t)))
#+end_src

