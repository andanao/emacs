#+title: Windows Config
#+PROPERTY: header-args:emacs-lisp :tangle ./windows.el :results none
I really wish I didn't have to use windows but sometimes you don't have a choice

#+begin_src emacs-lisp
(message (concat "loading " buffer-file-name))
(ads/leader-keys
  "eW" '(lambda () (interactive)
	   (find-file (concat ads/user-dir-emacs "windows.org"))
           :wk ".emacs Config"))
#+end_src


* Align Emacs and System Theme
:PROPERTIES:
:ID:       608313d5-6401-4a00-8aaf-4451531eb4ff
:END:
Set the windows theme color from powershell, doesn't work from regular windows command line for some reason ¯\_(ツ)_/¯

You can also set the system to light mode replacing the ~AppsUseLightTheme~ with ~SystemUsesLightTheme~ but I like things not looking like Windows 95

#+begin_src emacs-lisp
(if
    (string= (car ads/switch-themes-var) "ads-dark")
    (setq win-theme "0")
    (setq win-theme "1"))

(defun ads/windows-align-emacs-darkmode ()
  (interactive)
  (if
      (string= (car ads/switch-themes-var) "ads-dark")
      (setq win-theme "0")
    (setq win-theme "1"))
  (with-temp-buffer
    (shell-command
     (concat
      "powershell; New-ItemProperty -Path HKCU:/SOFTWARE/Microsoft/Windows/CurrentVersion/Themes/Personalize -Name AppsUseLightTheme -Value "
      win-theme
      " -Type Dword -Force; dir")
     t)))
#+end_src
* Hide Line Ends
:PROPERTIES:
:ID:       eec866e3-4e98-4d61-addb-dd2ca29cdc9d
:END:
Some the files I work with don't have consistent line endings DOS or UNIX

#+begin_src emacs-lisp
(defun hide-dos-eol ()
  "Do not show ^M in files containing mixed UNIX and DOS line endings."
  (interactive)
  (setq buffer-display-table (make-display-table))
  (aset buffer-display-table ?\^M []))
#+end_src
* Open Attatchment dir externally
:PROPERTIES:
:ID:       e7315482-1abe-4416-8c59-0de093746f0b
:END:

#+begin_src emacs-lisp
(defun org-attatch-open-win-explorer ()
  (interactive)
  (setq attatchment-dir (org-attach-dir-get-create))
  (w32-shell-execute 1 attatchment-dir))

#+end_src
